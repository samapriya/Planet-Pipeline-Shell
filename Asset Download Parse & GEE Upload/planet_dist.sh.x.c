#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -f planet_dist.sh 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\066"
#define      shll_z	10
#define      shll	((&data[3]))
	"\337\303\307\026\164\317\334\307\315\337\054\323\322"
#define      chk1_z	22
#define      chk1	((&data[17]))
	"\176\333\224\025\114\346\352\276\251\172\273\255\160\123\075\367"
	"\365\264\331\222\351\367\060\101\342\347\001\263\031"
#define      lsto_z	1
#define      lsto	((&data[43]))
	"\174"
#define      text_z	2482
#define      text	((&data[197]))
	"\316\223\172\070\175\326\374\065\110\063\366\351\023\271\274\234"
	"\115\156\033\050\002\003\051\265\035\235\362\257\144\062\226\062"
	"\305\020\152\103\346\147\170\057\232\156\030\256\050\325\112\165"
	"\103\146\235\105\151\307\373\206\145\355\066\311\037\314\373\345"
	"\334\145\051\303\315\241\362\147\020\013\025\071\340\140\256\043"
	"\306\113\151\060\023\144\266\170\122\355\101\162\271\074\127\226"
	"\242\201\131\157\042\114\327\063\127\355\154\070\116\032\134\024"
	"\146\305\105\172\052\374\362\174\351\063\356\242\160\106\071\022"
	"\307\222\202\352\336\131\036\066\107\212\157\225\245\314\252\014"
	"\221\357\206\274\353\170\070\324\254\306\256\233\323\345\002\227"
	"\312\341\364\053\110\044\307\306\167\165\276\152\015\117\241\131"
	"\336\224\114\120\266\332\205\003\235\272\110\047\273\114\010\366"
	"\145\107\273\102\104\341\335\026\040\252\072\214\143\216\063\233"
	"\166\327\041\126\135\043\217\050\060\366\330\354\134\303\170\131"
	"\103\353\113\221\033\071\012\025\245\012\241\135\003\206\152\224"
	"\026\030\145\344\010\056\106\062\314\031\367\125\015\160\273\207"
	"\342\226\001\061\016\174\324\222\320\325\015\250\214\254\036\107"
	"\346\023\222\023\346\205\060\341\334\146\112\236\115\240\232\055"
	"\253\272\175\236\347\074\160\321\071\126\163\265\070\164\253\330"
	"\011\223\003\373\356\224\336\314\021\176\337\120\033\026\261\374"
	"\351\121\357\172\122\147\237\010\021\203\011\360\203\200\276\317"
	"\356\003\275\223\214\361\061\310\171\211\144\331\155\161\351\124"
	"\220\174\135\371\217\323\046\345\004\212\055\233\237\173\301\305"
	"\200\154\204\243\165\023\356\073\266\332\101\314\230\056\342\246"
	"\266\315\261\016\053\361\153\175\264\224\152\305\245\362\343\021"
	"\033\045\036\203\167\221\102\205\112\143\026\146\310\270\134\255"
	"\344\226\172\113\202\214\200\133\202\130\110\152\245\331\313\320"
	"\261\343\333\020\111\214\362\054\327\261\376\046\057\242\210\342"
	"\335\102\071\214\343\072\344\201\141\343\236\336\021\056\336\075"
	"\313\111\230\002\143\117\367\335\301\133\013\204\337\056\122\000"
	"\355\206\143\146\313\042\024\146\376\013\043\305\271\332\036\041"
	"\333\304\026\205\321\307\323\303\365\105\271\240\116\105\351\117"
	"\002\067\376\171\355\315\125\337\064\201\214\345\104\163\346\172"
	"\170\366\360\111\035\053\320\203\162\377\226\217\366\327\253\060"
	"\251\364\057\166\355\352\263\134\370\017\134\210\350\053\010\047"
	"\340\267\344\235\161\103\027\050\377\137\027\311\177\241\265\257"
	"\040\367\130\001\304\221\124\164\262\253\037\102\040\320\035\324"
	"\052\220\326\313\326\045\234\225\023\333\373\147\143\044\264\307"
	"\043\301\334\073\111\017\247\017\220\055\125\337\272\150\360\015"
	"\336\204\073\257\165\261\104\227\260\136\062\225\074\104\205\300"
	"\177\006\017\157\135\244\044\245\157\346\147\241\357\136\233\352"
	"\360\105\057\351\175\347\043\256\043\315\221\165\063\176\334\110"
	"\066\330\101\204\250\237\202\320\215\352\046\353\120\377\032\103"
	"\007\276\063\260\242\235\036\031\217\273\216\133\254\140\044\123"
	"\353\322\166\175\211\227\154\373\312\231\310\320\233\260\032\217"
	"\125\027\307\174\365\362\153\255\020\065\376\163\013\264\136\113"
	"\034\104\253\327\253\013\122\125\043\166\277\351\201\267\113\134"
	"\317\026\243\223\253\075\152\222\344\320\354\013\371\165\254\033"
	"\006\114\316\131\163\340\373\247\205\231\336\064\004\331\072\333"
	"\324\024\045\226\071\061\316\360\151\123\364\207\152\065\032\111"
	"\346\226\040\212\121\071\012\054\200\351\227\274\323\305\206\263"
	"\251\036\351\376\255\241\337\227\360\257\200\304\254\300\062\137"
	"\071\007\014\120\225\101\007\150\167\201\334\133\212\277\103\326"
	"\371\305\176\003\156\005\036\270\344\064\372\377\201\325\062\112"
	"\272\262\244\222\020\026\372\062\266\357\344\050\274\221\261\272"
	"\141\073\334\216\071\355\067\370\252\333\160\242\053\101\075\176"
	"\203\302\251\102\063\064\016\045\236\002\214\073\160\306\120\200"
	"\344\060\345\001\137\041\067\172\124\327\055\206\241\167\007\277"
	"\124\370\110\302\115\217\124\112\312\235\343\010\214\207\256\155"
	"\377\210\221\222\323\034\253\051\370\233\343\015\151\370\215\065"
	"\375\104\135\011\172\131\163\113\357\244\161\114\204\145\005\025"
	"\352\370\046\177\264\204\154\173\114\275\314\140\017\305\075\012"
	"\173\243\265\002\147\321\202\116\107\324\264\016\147\256\266\200"
	"\154\076\344\152\244\132\242\100\011\155\066\140\212\007\270\273"
	"\366\304\001\260\302\363\254\221\226\000\161\026\207\050\174\332"
	"\256\057\064\014\341\054\337\200\330\043\041\057\136\273\012\011"
	"\072\261\036\115\376\222\064\243\270\315\310\040\165\370\322\203"
	"\326\374\342\005\221\206\202\302\041\365\344\160\065\062\333\110"
	"\062\115\315\215\247\201\245\265\012\006\007\372\344\001\305\001"
	"\344\304\326\132\213\260\067\252\243\374\201\342\142\231\004\150"
	"\275\056\204\144\130\065\054\327\061\155\346\201\251\332\042\352"
	"\140\321\100\352\350\052\320\232\161\023\311\367\270\103\307\324"
	"\134\117\311\367\034\050\167\075\066\271\353\002\305\136\316\340"
	"\315\163\225\123\324\155\367\240\363\305\363\153\245\100\240\350"
	"\105\006\204\051\255\334\070\020\376\362\127\256\004\077\335\174"
	"\251\244\364\235\144\344\246\133\024\115\201\004\132\005\105\245"
	"\371\377\302\005\251\361\375\160\146\047\305\360\010\100\132\062"
	"\272\331\371\025\102\243\006\227\005\200\232\307\142\321\166\305"
	"\116\175\025\327\275\344\022\220\245\130\367\235\301\144\027\253"
	"\035\072\113\010\242\027\015\142\303\107\265\263\146\344\260\255"
	"\013\374\056\013\366\121\104\246\026\053\062\061\141\127\110\320"
	"\224\242\343\050\355\007\305\137\042\231\171\046\007\210\220\316"
	"\041\127\071\265\312\112\354\173\324\126\276\317\371\357\313\065"
	"\041\251\113\164\034\064\344\236\241\366\054\226\213\040\075\175"
	"\243\005\056\240\345\147\347\213\056\311\343\361\227\231\332\250"
	"\326\261\346\152\306\225\313\142\377\252\140\314\077\310\062\157"
	"\133\115\321\116\335\316\120\035\315\314\267\364\246\025\117\112"
	"\231\131\032\170\356\267\373\076\271\043\025\120\334\063\175\063"
	"\131\323\016\060\334\224\246\053\327\332\217\310\104\254\001\220"
	"\034\272\040\200\055\167\272\362\224\112\233\305\276\010\214\163"
	"\145\000\075\215\156\362\334\021\105\115\104\200\161\206\235\314"
	"\073\222\325\037\225\341\200\261\024\073\026\105\213\134\125\244"
	"\312\347\340\221\322\241\227\220\371\131\214\357\117\062\176\373"
	"\021\115\313\066\143\122\220\305\365\115\047\220\211\317\312\061"
	"\271\044\302\046\152\167\075\146\153\132\163\063\111\056\351\310"
	"\033\302\246\275\105\273\167\317\236\150\100\365\257\301\044\147"
	"\311\062\021\034\066\271\263\145\140\123\130\171\014\334\104\025"
	"\141\203\200\021\125\211\320\141\123\033\274\027\110\220\154\117"
	"\323\271\232\025\217\057\216\306\251\166\273\051\102\262\245\145"
	"\202\053\250\316\116\225\114\243\251\034\157\325\373\350\240\023"
	"\041\201\323\154\133\107\142\222\322\353\301\056\313\145\061\300"
	"\100\200\363\133\324\110\373\210\145\001\053\041\362\374\356\003"
	"\246\201\101\201\114\310\012\313\175\173\222\201\264\014\325\114"
	"\310\370\170\335\143\154\130\136\164\323\126\171\057\172\170\223"
	"\046\366\217\113\313\071\167\125\301\371\140\333\267\023\156\250"
	"\255\233\015\210\101\137\141\170\030\035\202\245\336\274\323\206"
	"\300\251\170\346\340\245\265\326\041\273\346\114\154\362\125\207"
	"\337\042\366\220\310\361\325\262\123\346\014\311\020\367\134\361"
	"\040\321\276\062\022\112\372\225\160\210\206\366\133\123\270\123"
	"\372\217\373\107\304\033\376\171\077\176\111\374\375\246\245\020"
	"\065\227\305\204\053\111\244\014\117\256\072\167\077\004\121\362"
	"\350\146\213\171\101\077\347\125\001\103\350\036\277\310\000\171"
	"\222\054\275\010\001\103\275\117\331\007\037\176\031\112\057\010"
	"\165\216\204\221\143\205\277\131\307\060\115\103\252\024\254\171"
	"\320\172\373\336\010\115\104\140\177\006\307\054\226\210\127\313"
	"\315\312\302\274\230\354\304\210\245\125\362\074\311\131\343\063"
	"\323\376\205\335\147\042\222\107\201\252\036\211\076\042\371\170"
	"\047\345\136\334\145\347\342\122\153\142\371\025\153\322\033\354"
	"\373\307\201\240\050\074\351\134\217\042\325\246\207\033\252\132"
	"\153\276\301\205\141\021\050\234\306\152\203\024\103\004\077\011"
	"\327\237\254\016\050\246\124\015\277\021\031\167\130\341\003\135"
	"\232\217\216\234\320\141\041\217\352\040\005\046\052\211\130\220"
	"\262\236\140\120\322\177\001\027\310\143\363\273\102\011\114\131"
	"\107\076\254\041\216\264\367\047\333\361\261\354\300\175\010\117"
	"\160\076\274\005\057\370\367\024\142\110\120\316\003\011\077\035"
	"\041\243\330\166\044\006\060\336\232\067\376\352\200\103\112\170"
	"\266\030\147\237\111\307\362\026\241\117\245\146\310\213\375\104"
	"\345\100\000\231\114\326\126\272\116\321\320\134\001\054\017\065"
	"\123\052\332\145\167\212\001\203\233\100\045\163\044\170\332\024"
	"\127\244\134\216\157\142\214\064\263\137\037\341\256\031\053\061"
	"\353\225\200\205\321\372\066\130\116\142\023\024\170\173\154\271"
	"\132\230\364\204\006\045\151\020\074\324\062\136\150\233\040\007"
	"\013\261\055\013\270\100\362\176\203\026\230\314\025\014\062\074"
	"\276\315\343\001\167\120\127\302\176\221\321\071\113\131\223\162"
	"\340\172\067\167\353\075\105\135\357\012\241\214\230\123\056\123"
	"\222\045\133\266\317\225\131\213\104\321\270\130\130\032\043\171"
	"\172\221\265\031\375\372\232\252\167\323\041\074\221\160\170\161"
	"\330\312\026\271\056\266\170\045\172\173\220\225\242\310\256\070"
	"\041\304\205\307\373\001\325\152\215\145\363\100\210\056\043\317"
	"\031\320\024\330\153\052\025\121\375\230\162\112\046\234\350\246"
	"\353\342\322\271\177\110\010\006\231\317\162\113\062\105\274\063"
	"\060\267\155\033\165\263\351\255\165\346\326\237\102\070\051\004"
	"\026\263\143\323\111\342\123\235\012\024\253\204\246\333\105\127"
	"\016\201\207\053\017\204\150\346\023\367\033\317\250\021\274\253"
	"\061\227\355\014\316\316\066\061\042\131\207\146\373\224\372\327"
	"\154\322\340\363\176\227\164\226\125\340\020\244\006\006\351\157"
	"\377\250\145\327\310\151\112\136\027\056\304\032\156\227\112\057"
	"\016\040\165\125\123\213\266\054\274\301\253\144\040\046\134\276"
	"\331\051\233\100\221\205\043\160\365\344\020\317\137\200\156\105"
	"\312\140\033\014\054\157\122\144\201\200\364\147\267\300\220\113"
	"\103\125\143\232\370\106\251\324\353\237\125\276\016\160\341\165"
	"\170\330\304\221\353\264\346\033\243\361\142\211\153\307\011\015"
	"\064\207\371\234\071\235\203\216\007\163\207\040\120\262\227\340"
	"\045\077\034\263\010\177\145\077\017\031\005\370\106\047\012\102"
	"\133\277\366\104\326\072\026\257\235\267\060\121\321\374\033\144"
	"\172\213\303\133\214\315\352\177\360\070\342\027\121\021\067\203"
	"\041\004\215\105\102\012\002\365\005\275\201\234\313\013\155\237"
	"\327\367\066\012\074\151\310\022\364\166\301\216\370\343\007\231"
	"\126\114\201\300\177\073\162\054\225\163\036\210\102\010\353\106"
	"\013\111\145\070\005\120\311\331\257\256\072\021\067\221\016\317"
	"\225\012\000\161\163\242\107\302\163\067\103\155\072\067\155\337"
	"\356\232\317\037\313\077\332\076\046\232\356\020\351\143\275\346"
	"\234\177\373\357\244\224\155\141\111\231\010\153\001\167\176\216"
	"\135\127\331\177\160\340\136\311\227\141\224\111\172\374\016\225"
	"\027\311\312\374\003\146\221\347\145\036\202\047\167\034\155\260"
	"\056\065\103\261\037\042\012\075\130\122\310\310\347\156\224\221"
	"\172\046\200\001\342\154\171\032\101\046\102\271\102\260\152\161"
	"\345\255\042\005\320\055\103\051\177\013\361\146\171\205\370\364"
	"\254\171\365\216\346\157\251\047\225\353\340\327\233\113\110\201"
	"\371\153\206\311\230\311\362\027\325\344\176\116\151\167\103\026"
	"\360\071\244\326\250\116\376\076\071\337\026\325\052\137\126\043"
	"\312\334\355\142\245\337\172\173\303\370\312\055\157\015\103\140"
	"\106\350\067\357\066\065\055\160\024\104\105\077\243\233\143\155"
	"\170\120\320\036\060\112\231\364\102\143\042\262\160\146\023\267"
	"\116\112\247\205\177\324\365\224\031\072\324\274\326\067\051\116"
	"\210\372\154\271\104\005\255\207\151\320\072\332\066\115\221\205"
	"\227\070\012\027\015\377\254\046\072\201\342\021\270\014\137\101"
	"\007\314\373\113\322\251\322\073\171\014\026\257\132\247\065\361"
	"\340\077\011\355\077\266\024\172\067\367\213\360\004\353\061\013"
	"\270\054\126\213\326\051\306\117\066\335\377\220\204\064\202\145"
	"\164\214\123\263\102\147\056\171\137\271\152\143\245\233\157\135"
	"\310\305\350\236\357\257\356\045\214\355\266\021\041\070\166\225"
	"\304\312\111\007\061\167\201\221\061\353\364\327\207\143\065\117"
	"\051\036\356\031\316\335\076\133\312\365\154\354\055\343\202\362"
	"\255\314\371\337\104\172\160\165\145\145\115\355\311\202\075\363"
	"\240\053\014\156\011\113\311\324\100\066\300\155\032\103\140\310"
	"\020\132\250\124\325\031\312\073\176\027\050\110\232\145\073\072"
	"\221\107\251\232\222\163\156\322\251\057\100\304\163\241\214\203"
	"\374\065\327\321\116\242\014\315\271\065\025\123\232\121\216\054"
	"\230\067\306\053\253\065\376\125\145\077\031\331\340\246\134\334"
	"\333\064\256\051\326\272\367\220\360\014\344\213\135\162\267\366"
	"\252\176\041\125\264\040\252\031\137\304\363\100\152\120\034\106"
	"\204\312\160\133\205\147\354\166\164\320\001\321\103\270\310\355"
	"\066\352\103\352\012\356\004\152\262\370\252\035\110\306\143\315"
	"\221\323\050\027\072\025\215\256\345\216\200\051\106\110\027\175"
	"\063\132\147\076\111\154\250\373\144\122\030\254\030\173\172\252"
	"\117\242\301\211\270\116\070\236\334\270\307\043\001\336\240\065"
	"\071\010\163\202\165\033\176\332\155\227\207\206\022\001\060\141"
	"\244\361\353\134\100\043\372\035\334\302\100\336\241\341\023\332"
	"\352\206\135\137\241\334\071\016\163\301"
#define      msg2_z	19
#define      msg2	((&data[3240]))
	"\304\350\101\147\035\052\307\160\273\321\267\215\276\351\101\004"
	"\147\364\022\064\170\146\266\323"
#define      tst2_z	19
#define      tst2	((&data[3266]))
	"\275\024\323\200\165\046\147\160\071\211\012\313\150\230\057\345"
	"\235\306\142\202\015\156\225\125\262\041\066"
#define      chk2_z	19
#define      chk2	((&data[3293]))
	"\113\131\200\354\245\152\067\022\244\144\364\137\073\317\211\205"
	"\353\210\326\251\315\172\025"
#define      inlo_z	3
#define      inlo	((&data[3312]))
	"\354\204\126"
#define      rlax_z	1
#define      rlax	((&data[3315]))
	"\212"
#define      date_z	1
#define      date	((&data[3316]))
	"\205"
#define      msg1_z	42
#define      msg1	((&data[3324]))
	"\353\147\002\343\045\026\267\161\011\166\054\160\162\055\073\207"
	"\230\253\127\170\003\176\011\164\144\116\330\214\363\206\131\316"
	"\204\061\112\100\242\047\224\305\204\014\125\217\013\223\365\041"
	"\023"
#define      pswd_z	256
#define      pswd	((&data[3393]))
	"\306\242\056\302\303\171\034\104\146\122\377\141\373\173\360\052"
	"\271\105\102\135\120\055\305\122\020\353\150\015\135\234\143\324"
	"\140\337\225\350\163\304\346\106\234\126\351\050\160\046\076\321"
	"\007\353\327\052\103\377\153\200\105\061\216\243\315\362\170\055"
	"\321\016\025\105\322\373\213\156\122\165\227\302\233\326\223\243"
	"\301\153\316\004\152\071\205\260\152\023\123\070\005\313\145\327"
	"\331\172\034\254\166\250\032\310\035\262\213\271\210\037\134\111"
	"\212\052\116\365\144\323\245\317\347\371\007\355\305\154\304\236"
	"\347\341\112\136\211\145\046\247\030\262\140\241\321\274\353\134"
	"\347\071\122\113\014\370\032\364\361\042\341\266\217\245\125\167"
	"\207\240\325\020\006\373\267\036\256\030\300\177\325\253\334\274"
	"\344\056\010\361\046\043\345\030\105\306\316\324\154\044\113\363"
	"\304\040\004\313\034\274\352\313\324\252\113\252\125\047\146\072"
	"\126\156\053\174\221\020\225\327\327\144\254\104\210\367\067\115"
	"\030\074\030\065\370\003\000\315\255\113\167\003\163\336\075\311"
	"\115\151\106\336\172\333\266\121\077\142\225\310\132\315\025\162"
	"\011\056\250\002\061\251\320\337\365\107\342\150\046\037\062\163"
	"\210\170\121\002\124\007\124\223\152\351\134\307\220\324\060\127"
	"\166\137\031\072\330\065\177\076\207\176\240\203\371\220\255\262"
	"\325\360\020\046\035"
#define      xecc_z	15
#define      xecc	((&data[3676]))
	"\301\366\075\331\173\176\174\367\134\256\151\000\227\053\145\247"
#define      tst1_z	22
#define      tst1	((&data[3696]))
	"\264\047\251\053\206\247\377\131\116\241\265\177\107\122\106\140"
	"\033\173\133\273\002\000\114\271\175\127\207\303"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
